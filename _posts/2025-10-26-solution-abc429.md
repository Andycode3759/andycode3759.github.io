---
title: 题解 - ABC429
date: 2025-10-26 12:33:44 +0800
categories: [题解]
tags: [atcoder, abc]
math: true
---

[题目列表](https://atcoder.jp/contests/abc429/tasks)

## C - Odd One Subsequence / 奇异子序列

> 输入一个长度为 $n$ 的数组 $\{A_n\}$，求满足如下条件的三元组 $(i,j,k)$ 的数量：
>
> - $1 \leq i < j < k \leq n$
>
> - $A_i,A_j,A_k$ 中恰有两个元素相同，而另一个元素与它们不同。
>
> 数据范围：$3 \leq n \leq 2 \times 10^5, 1 \leq A_i \leq n$

统计每一个数的出现次数，记为 $c_x$。对于给定的数 $x$，从数组中任意选择两个 $x$ 和一个非 $x$ 的数即可组成一个符合题意的三元组。这是一个简单的排列组合问题，可以算出数 $x$ 贡献的答案为 $C_{c_x}^2(n-c_x)={1 \over 2}c_x(c_x-1)(n-c_x)$。对所有 $x$ 的贡献求和即为最终答案。

## D - On AtCoder Conference / AtCoder 大会

> 有一个周长为 $m$ 的圆，选定一个点为零点，规定坐标 $x$ 所在的位置为从零点开始绕圆顺时针运动距离 $x$ 所到达的位置。有 $n$ 个人站在圆上，每个人的位置坐标都是 $[0,m-1]$ 的整数，可能有多个人站在同一点。给定一个常数 $c$，对于 $[0,m-1]$ 内的每个整数 $i$，定义 $X_i$ 如下：
>
> - 一个动点从坐标 $i+0.5$ 的位置出发，绕圆顺时针运动，当动点累计路过的人的数量大于等于 $c$ 时，立即停止运动，$X_i$ 为此时动点实际遇到过的人数。
>
> 求所有 $X_i$ 的和，即 $\Sigma _{0 \leq i \leq m-1}X_i$。
>
> 数据范围：$1 \leq n \leq 5 \times 10^5, 1 \leq m \leq 10^{12}, 1 \leq c \leq n$

求单个的 $X_i$ 容易想到二分：统计每个位置的人数，化曲为直（将环剪断后复制一份再拼接）再做前缀和，二分查找动点结束运动的位置。因为 $c \leq n$，所以动点的运动不会超过一整圈，因此将坐标复制一份就够了。

但是 $m$ 的数量级有 $10^{12}$，无论是时间还是空间都不允许我们达到 $O(m \log m)$ 的复杂度。使用离散化进行处理：只考虑有人的坐标点位，从小到大依次为这些坐标编号为 $1,2,3,\dots$，这样编号不会超过 $n$，并且直接把编号看作坐标来求 $X_i$ 也不会影响正确性，因为这相当于忽略了所有没有人的位置。

之后考虑求答案的问题。容易发现，无人点处的 $X_i$ 一定等于逆时针方向上离它最近的有人点的 $X_j$。因此可以在离散化后给每个编号分配一个答案贡献倍率，等于下一个编号的实际坐标与本编号的实际坐标之差。

细节上需要注意，离散化时无论零点有没有站人都一定要给坐标 0 编号，不然会漏掉前面一段的答案；最后一个编号的贡献倍率是 $m-实际坐标$。时间复杂度为 $O(n \log n)$。

## E - Hit and Away / 躲避袭击

## F - Shortest Path Query / 最短路查询

## G - Sum of Pow of Mod of Linear / 线性的模的幂次的和
